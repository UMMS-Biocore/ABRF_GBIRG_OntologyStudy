pvals <- tmp[,c(1,17)]
ggplot() + geom_point(data=pvals, aes(x=Collection,y=PPAR.E.C.FDR.q-val))
ggplot() + geom_point(data=pvals, aes(x=pvals$Collection,y=pvals$PPAR.E.C.FDR.q-val))
ggplot() + geom_point(data=pvals, aes(x=pvals$Collection, y=pvals$PPAR.E.C.FDR.q-val))
pvals$PPAR.E.C.FDR.q-val
pvals$`PPAR.E.C.FDR.q-val`
ggplot() + geom_point(data=pvals, aes(x=pvals$Collection, y=pvals$`PPAR.E.C.FDR.q-val`))
ggplot() + geom_point(data=pvals, aes(y=pvals$`PPAR.E.C.FDR.q-val`))
ggplot() + geom_point(data=pvals, aes(y=`PPAR.E.C.FDR.q-val`))
ggplot() + geom_point(data=pvals, aes(x="test",y=`PPAR.E.C.FDR.q-val`))
ggplot() + geom_point(data=pvals, aes(x="test",y=`PPAR.E.C.FDR.q-val`)) + coord_flip()
View(pvals)
ggplot() + geom_jitter(data=pvals, aes(x="test",y=`PPAR.E.C.FDR.q-val`)) + coord_flip()
ggplot() + geom_point(data=pvals, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`)) + coord_flip()
ggplot() + geom_point(data=pvals, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`)) + coord_flip()
pvals["LIPID"]
tmp <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tmp[,c(1,17)]
pvals <- tibble::rownames_to_column(pvals,"SetName")
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`)
head(ppar)
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`) %>% mutate(test=SetName)
head(ppar)
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`) %>% mutate(releveant=case_when(SetName(contains("LIPID")) ~ "Hit")
)
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`) %>% mutate(releveant=case_when(SetName(contains("LIPID")) ~ "Hit")
)
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`)
View(ppar)
ppar <- ppar %>% mutate(releveant=case_when(SetName(contains("LIPID")) ~ "Hit")
)
ppar <- ppar %>% mutate(releveant=case_when(grepl("LIPID", SetName) ~ "Hit")
)
ppar <- ppar %>% mutate(releveant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=pvals, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`)) + coord_flip()
knitr::opts_chunk$set(echo = TRUE)
library(openxlsx)
library(ggplot2)
library(tidyverse)
gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`)
ppar <- ppar %>% mutate(releveant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=pvals, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`)) + coord_flip()
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`)
ppar <- ppar %>% mutate(releveant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`)) + coord_flip()
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`)
ppar <- ppar %>% mutate(releveant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`, color="relevant")) + coord_flip()
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`)
ppar <- ppar %>% mutate(releveant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`, color="releveant")) + coord_flip()
library(openxlsx)
library(ggplot2)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(openxlsx)
library(ggplot2)
library(tidyverse)
gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,FractionMatches,`PPAR.E.C.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x="test",y=`PPAR.E.C.FDR.q-val`, color=factor(relevant))) + coord_flip()
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`PPAR.E.C.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`PPAR.E.C.FDR.q-val`, color=factor(relevant))) + coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`PPAR.E.C.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`PPAR.E.C.FDR.q-val`, color=factor(relevant))) + coord_flip()
gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
eVc <- read.xlsx("PPAR_EvC_GSEAv4.xlsx", colNames=TRUE, rowNames=TRUE)
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("LIPID", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`PPAR.E.C.FDR.q-val`, color=factor(relevant))) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant))) + coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("_PPAR", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant))) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant))) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter",
aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant)))
+ scale_alpha_manual(guide='none', values = list(a=0.2, point=1))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant))) + scale_alpha_manual(guide='none', values = list(a=0.2, point=1)) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(guide='none', values = list(a=0.2, point=1)) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), size=size,alpha=relevant)) + scale_alpha_manual(guide='none', values = list(a=0.2, point=1)) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), size=size,alpha=relevant)) + scale_alpha_manual(guide='none', values = list(relevant=1)) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(guide='none', values = list(relevant=1)) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant))) + + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant))) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant)) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant)) + coord_flip()
`PPAR.E.C.FDR.q-val`
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant))) + coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("_PPAR", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant))) + coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant))+ scale_alpha_manual(guide='none',values=list(NA=0.2, Hit=1))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant))+ scale_alpha_manual(guide='none',values=list(Hit=1))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant))+ coord_flip() #scale_alpha_manual(guide='none',values=list(Hit=1))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("_PPAR", SetName) ~ "Hit", is.na(x) ~ "other"))
ppar <- ppar %>% mutate(relevant=case_when(grepl("_PPAR", SetName) ~ "Hit", is.na() ~ "other"))
ppar <- ppar %>% mutate(relevant=case_when(grepl("_PPAR", SetName) ~ "Hit")
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("_PPAR", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant)))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant)))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=rev(factor(relevant)))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=rev(factor(relevant)))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=rev(relevant))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=rev(relevant)))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant)))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=case_when(grepl("_PPAR", SetName) ~ "Hit"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant)))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=0.1))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant)))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant))) + scale_alpha_discrete(range=c(1, 0.2))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=factor(relevant))) + scale_alpha_manual(values=c(1, 0.2))+ coord_flip()
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.2))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.2))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x="test",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_point(data=ppar, position = "jitter", width = 0.2, aes(x="test",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_point(data=ppar, position = "jitter", aes(x="test",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="test",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Set",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1)) set_color_manual(values=c("red","grey") + coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Set",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(1, 0.5)) + coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(4, 1)) + coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","grey"))+ coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "PPAR", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_stripchart(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
library(repr)
library(reprex)
library(openxlsx)
library(ggplot2)
library(tidyverse)
library(reprex)
ggplot() + geom_jitter(data=ppar, aes(x=Collection,y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=5, height = 1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=5, height = 1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=5, height = 1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_point(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant, width=0.1)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_point(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_point(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_bw()
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
#ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
#ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
#ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
#ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
#ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
#ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
eVcGSEA <- read.xlsx("PPAR_EvC_GSEAv4_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
eVc <- read.xlsx("PPAR_EvC_GSEAv4.xlsx", colNames=TRUE, rowNames=TRUE)
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcGSEA <- read.xlsx("PPAR_EvC_GSEAv4_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.4)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.4)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.05) + scale_alpha_manual(values=c(1, 0.4)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.4)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
#gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
eVc <- read.xlsx("PPAR_EvC_GSEAv4.xlsx", colNames=TRUE, rowNames=TRUE)
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcGSEA <- read.xlsx("PPAR_EvC_GSEAv4_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
#pvals <- gsea %>% filter(`PPAR.E.C.FDR.q-val` <= 0.05 & FractionMatches < 0.1)
pvals <- eVc %>% filter(`EvC.norm.stat.FDR.q-val` <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"SetName")
ppar <- pvals %>% select(SetName,Collection,FractionMatches,`EvC.norm.stat.FDR.q-val`)
ppar <- ppar %>% mutate(relevant=ifelse(grepl("_PPAR", SetName), "Hit", "Other"))
ggplot() + geom_jitter(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=ppar, aes(x="Group",y=`EvC.norm.stat.FDR.q-val`, color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.05) + scale_alpha_manual(values=c(1, 0.4)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.4)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.05) + scale_alpha_manual(values=c(1, 0.3)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.3)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.05) + scale_alpha_manual(values=c(1, 0.3)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.3)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.05) + scale_alpha_manual(values=c(1, 0.3)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.3)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.05) + scale_alpha_manual(values=c(1, 0.2)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.2)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.2)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.2)) + scale_size_manual(values=c(4, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_bw()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
eVcDAVID <- read.xlsx("PPAR_EvC_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcDAVID %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Term")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcDAVID %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Term")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
#ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + #scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcGSEA %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Name")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
#ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + #scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcMetacore %>% filter(FDR <= 0.05)
pvals <- tibble::rownames_to_column(pvals,"Result")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
#ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + #scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#pvals <- eVcDAVID %>% filter(FDR <= 0.05)
pvals <- eVcDAVID
pvals <- tibble::rownames_to_column(pvals,"Term")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
#ggplot() + geom_point(data=pvals, aes(x="Group",y=FDR, , color=factor(relevant), alpha=relevant, size=relevant)) + scale_alpha_manual(values=c(1, 0.05)) + #scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcDAVID
pvals <- tibble::rownames_to_column(pvals,"Term")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip() + theme_void()
pvals <- eVcDAVID
pvals <- tibble::rownames_to_column(pvals,"Term")
ggplot() + geom_jitter(data=pvals, aes(x="Group",y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
table(pvals)
table(pvals$relevant)
table(pvals$relevant,pvals$Category)
pvals <- eVcDAVID
pvals <- tibble::rownames_to_column(pvals,"Term")
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(relevant), alpha=relevant, size=relevant), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
#gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
eVc <- read.xlsx("PPAR_EvC_GSEAv4.xlsx", colNames=TRUE, rowNames=TRUE)
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcGSEA <- read.xlsx("PPAR_EvC_GSEAv4_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.degs <- read.xlsx("EvC_degs_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.upE <- read.xlsx("EvC_upE_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.upC <- read.xlsx("EvC_upC_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcDAVID.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
head(eVcDAVID.degs)
pvals <- eVcDAVID.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcDAVID.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals
#gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
eVc <- read.xlsx("PPAR_EvC_GSEAv4.xlsx", colNames=TRUE, rowNames=TRUE)
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcGSEA <- read.xlsx("PPAR_EvC_GSEAv4_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.degs <- read.xlsx("EvC_degs_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.upE <- read.xlsx("EvC_upE_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.upC <- read.xlsx("EvC_upC_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcDAVID.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.1)) + scale_size_manual(values=c(3, 1)) + scale_color_manual(values=c("red","black"))+ coord_flip()
pvals <- eVcDAVID.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.1, 0.1)) + scale_size_manual(values=c(3, 1,1)) + scale_color_manual(values=c("red","black","black"))+ coord_flip()
pvals <- eVcDAVID.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.5, 0.1)) + scale_size_manual(values=c(3, 2,1)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
#gsea <- read.xlsx("GSEA_Together_SelectedData_withFPflag.xlsx", colNames=TRUE, rowNames=TRUE)
eVc <- read.xlsx("PPAR_EvC_GSEAv4.xlsx", colNames=TRUE, rowNames=TRUE)
eVcMetacore <- read.xlsx("PPAR_EvC_MetacorePlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcGSEA <- read.xlsx("PPAR_EvC_GSEAv4_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.degs <- read.xlsx("EvC_degs_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.upE <- read.xlsx("EvC_upE_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcDAVID.upC <- read.xlsx("EvC_upC_DAVIDPlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcDAVID.upC
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.5, 0.1)) + scale_size_manual(values=c(3, 2,1)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
pvals <- eVcDAVID.upE
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.5, 0.1)) + scale_size_manual(values=c(3, 2,1)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
pvals <- eVcDAVID.upE
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.6, 0.2)) + scale_size_manual(values=c(3, 2,2)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
summarise(pvals)
summary(pvals$Category)
table(pvals$Category)
table(pvals$Category,pvals$Hit)
pvals <- eVcDAVID.upE
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,FDR,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.6, 0.2)) + scale_size_manual(values=c(4,2,2)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
eVcgprofiler.degs <- read.xlsx("EvC_degs_gProfiler_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
eVcgprofiler.degs <- read.xlsx("EvC_degs_gProfiler_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcgprofiler.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,p_value,Hit)
head(eVcgprofiler.degs)
head(pvals)
pvals %>% select(Term,source,p_value,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.6, 0.2)) + scale_size_manual(values=c(4,2,2)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
ggplot() + geom_jitter(data=pvals, aes(x=source,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.6, 0.2)) + scale_size_manual(values=c(4,2,2)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
eVcgprofiler.degs <- read.xlsx("EvC_degs_gProfiler_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcgprofiler.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,p_value,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=FDR, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.6, 0.2)) + scale_size_manual(values=c(4,2,2)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
pvals <- eVcgprofiler.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,p_value,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=p_value, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.6, 0.2)) + scale_size_manual(values=c(4,2,2)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
pvals
eVcgprofiler.degs <- read.xlsx("EvC_degs_gProfiler_PlusOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
pvals <- eVcgprofiler.degs
pvals <- tibble::rownames_to_column(pvals,"Term")
pvals %>% select(Term,Category,p_value,Hit)
ggplot() + geom_jitter(data=pvals, aes(x=Category,y=p_value, color=factor(Hit), alpha=Hit, size=Hit), width=0.1) + scale_alpha_manual(values=c(1, 0.6, 0.2)) + scale_size_manual(values=c(4,2,2)) + scale_color_manual(values=c("red","blue","black"))+ coord_flip()
knitr::opts_chunk$set(echo = TRUE)
library(openxlsx)
library(ggplot2)
library(tidyverse)
library(ggpubr)
