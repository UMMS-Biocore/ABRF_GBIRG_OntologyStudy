plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50000)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcDE <- read.xlsx("../shared_data/EvC_data.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
ggplot(evcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("EvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcDE <- read.xlsx("../shared_data/EvC_data.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
ggplot(evcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("EvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcDE <- read.xlsx("../shared_data/EvC_data.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
ggplot(evcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("EvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcDE <- read.xlsx("../shared_data/EvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
ggplot(evcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("EvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcDE <- read.xlsx("../shared_data/EvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
ggplot(evcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("EvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcDE <- read.xlsx("../shared_data/EvC_data.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart_data.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
ggplot(evcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("EvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
evcDE <- read.xlsx("../shared_data/EvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
evcDE <- evcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE <- read.xlsx("../shared_data/G1vRev_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
avcDE <- read.xlsx("../shared_data/hpm3_AvC_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
avcDE <- avcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE <- read.xlsx("../shared_data/musc_SkeVHeart_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
ggplot(evcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("EvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("G1vRev differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(avcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("AvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
ggtitle("SvC differential expression") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_y_continuous(limits = c(0,50)) +
scale_x_continuous(limits = c(-15,15)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
table(evcDE$threshold)
table(g1revDE$threshold)
table(avcDE$threshold)
table(svcDE$threshold)
table(plus300$Group)
table(msig7.2$Group)
ddply(msig7.2, .(Group), mutate, med.val.plyr=median(vals))
summarize(Mean = mean(msig7.2, na.rm=TRUE))
msig7.2 %>% group_by(Group) %>% summarize(mean(size))
head(msig7.2)
msig7.2 %>% group_by(Group) %>% summarize(mean(Size))
msig7.2 %>% group_by(Group) %>% summarize(median(Size))
groupMedians <- msig7.2 %>% group_by(Group) %>% summarize(median(Size))
groupMedians
as.data.frame(groupMedians)
ggsummarystats(msig7.2, x="Group", y="Size") + scale_x_discrete(limits = c("HALLMARK", "c2cgp", "c2cp", "KEGG", "BIOCARTA", "PID", "REACTOME", "WP", "c5bp", "c5cc", "c5mf"))
msig7.2 <- read.xlsx("../shared_data/msigdb_genesetsInfo_v7.2_paperSubset.xlsx", colNames=TRUE, rowNames=TRUE)
sub300 <- msig7.2 %>% filter(Size <= 300)
plus300 <- msig7.2 %>% filter(Size > 300)
ggplot(msig7.2, aes(Group, Size)) + geom_boxplot() + coord_cartesian(ylim = c(0, 300)) +
scale_x_discrete(limits = c("HALLMARK", "c2cgp", "c2cp", "KEGG", "BIOCARTA", "PID", "REACTOME", "WP", "c5bp", "c5cc", "c5mf"))
table(plus300$Group)
table(sub300$Group)
table(msig7.2$Group)
groupMedians <- msig7.2 %>% group_by(Group) %>% summarize(median(Size))
?summarize
msig7.2 %>% group_by(Group) %>% summarize(median(Size))
msig7.2 %>% group_by(Group) %>% summarize(median(Size), mean(Size))
msig7.2 %>% group_by(Group) %>% summarize(median(Size), mean(Size), count(Size))
msig7.2 %>% group_by(Group) %>% summarize(median(Size), mean(Size), n(Size))
msig7.2 %>% group_by(Group) %>% summarize(median(Size), mean(Size), n())
msig7.2 %>% group_by(Group) %>% summarize(n(),median(Size), mean(Size)
)
msig7.2 %>% group_by(Group) %>% summarize(n(),median(Size), mean(Size))
msig7.2 <- read.xlsx("../shared_data/msigdb_genesetsInfo_v7.2_paperSubset.xlsx", colNames=TRUE, rowNames=TRUE)
sub300 <- msig7.2 %>% filter(Size <= 300)
plus300 <- msig7.2 %>% filter(Size > 300)
ggplot(msig7.2, aes(Group, Size)) + geom_boxplot() + coord_cartesian(ylim = c(0, 300)) +
scale_x_discrete(limits = c("HALLMARK", "c2cgp", "c2cp", "KEGG", "BIOCARTA", "PID", "REACTOME", "WP", "c5bp", "c5cc", "c5mf"))
table(plus300$Group)
table(sub300$Group)
table(msig7.2$Group)
groupMedians <- msig7.2 %>% group_by(Group) %>% summarize(n(),median(Size), mean(Size))
msig7.2 <- read.xlsx("../shared_data/msigdb_genesetsInfo_v7.2_paperSubset.xlsx", colNames=TRUE, rowNames=TRUE)
sub300 <- msig7.2 %>% filter(Size <= 300)
plus300 <- msig7.2 %>% filter(Size > 300)
ggplot(msig7.2, aes(Group, Size)) + geom_boxplot() + coord_cartesian(ylim = c(0, 300)) +
scale_x_discrete(limits = c("HALLMARK", "c2cgp", "c2cp", "KEGG", "BIOCARTA", "PID", "REACTOME", "WP", "c5bp", "c5cc", "c5mf"))
table(plus300$Group)
table(sub300$Group)
table(msig7.2$Group)
as.data.frame(msig7.2 %>% group_by(Group) %>% summarize(n(),median(Size), mean(Size)))
knitr::opts_chunk$set(echo = TRUE)
EvC.ipath <- read.xlsx("../shared_data/EvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(openxlsx)
library(ggplot2)
library(tidyverse)
library(ggpubr)
library(pastecs)
EvC.ipath <- read.xlsx("../shared_data/EvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.ipath <- read.xlsx("../shared_data/G1vRev_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
EvC.ipath <- read.xlsx("../shared_data/EvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.ipath <- read.xlsx("../shared_data/G1vRev_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
hpm3AvC.ipath <- read.xlsx("../shared_data/hpm3_AvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
MuscleSvC.ipath <- read.xlsx("../shared_data/Muscle_SkeletalvsCardiac_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
p.Cutoff <- 0.05
evc.ipath.filt <- EvC.ipath %>% filter(pv_fdr <= p.Cutoff)
evc.ipath.filt <- tibble::rownames_to_column(evc.ipath.filt,"UniqName")
evc.ipath.nohit <- evc.ipath.filt %>% filter(Hit == "Other")
evc.ipath.hit <- evc.ipath.filt %>% filter(Hit == "Hit")
ec.ipath.plot <- ggplot() + geom_jitter(data=evc.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=evc.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("EvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.ipath.filt <- G1vRev.ipath %>% filter(pv_fdr <= p.Cutoff)
g1vrev.ipath.filt <- tibble::rownames_to_column(g1vrev.ipath.filt,"UniqName")
g1rev.ipath.nohit <- g1vrev.ipath.filt %>% filter(Hit == "Other")
g1rev.ipath.hit <- g1vrev.ipath.filt %>% filter(Hit == "Hit")
g1rev.ipath.plot <- ggplot() + geom_jitter(data=g1rev.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + theme_void() + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
#no hits here so this line was extracted
#geom_jitter(data=g1rev.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1)
hpm3AvC.ipath.filt <- hpm3AvC.ipath %>% filter(pv_fdr <= p.Cutoff)
EvC.ipath <- read.xlsx("../shared_data/EvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.ipath <- read.xlsx("../shared_data/G1vRev_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
hpm3AvC.ipath <- read.xlsx("../shared_data/hpm3_AvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
MuscleSvC.ipath <- read.xlsx("../shared_data/Muscle_SkeletalvsCardiac_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
EvC.ipath <- read.xlsx("../shared_data/EvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
G1vRev.ipath <- read.xlsx("../shared_data/G1vRev_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
hpm3AvC.ipath <- read.xlsx("../shared_data/hpm3_AvC_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
MuscleSvC.ipath <- read.xlsx("../shared_data/Muscle_SkeletalvsCardiac_ipathway_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
p.Cutoff <- 0.05
evc.ipath.filt <- EvC.ipath %>% filter(pv_fdr <= p.Cutoff)
evc.ipath.filt <- tibble::rownames_to_column(evc.ipath.filt,"UniqName")
evc.ipath.nohit <- evc.ipath.filt %>% filter(Hit == "Other")
evc.ipath.hit <- evc.ipath.filt %>% filter(Hit == "Hit")
ec.ipath.plot <- ggplot() + geom_jitter(data=evc.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=evc.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("EvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
g1vrev.ipath.filt <- G1vRev.ipath %>% filter(pv_fdr <= p.Cutoff)
g1vrev.ipath.filt <- tibble::rownames_to_column(g1vrev.ipath.filt,"UniqName")
g1rev.ipath.nohit <- g1vrev.ipath.filt %>% filter(Hit == "Other")
g1rev.ipath.hit <- g1vrev.ipath.filt %>% filter(Hit == "Hit")
g1rev.ipath.plot <- ggplot() + geom_jitter(data=g1rev.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=g1rev.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("g1rev") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
#no hits here so this line was extracted
#geom_jitter(data=g1rev.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1)
hpm3AvC.ipath.filt <- hpm3AvC.ipath %>% filter(pv_fdr <= p.Cutoff)
hpm3AvC.ipath.filt <- tibble::rownames_to_column(hpm3AvC.ipath.filt,"UniqName")
ac.ipath.nohit <- hpm3AvC.ipath.filt %>% filter(Hit == "Other")
ac.ipath.hit <- hpm3AvC.ipath.filt %>% filter(Hit == "Hit")
ac.ipath.plot <- ggplot() + geom_jitter(data=ac.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.5, size=0.6, width=0.1) + geom_jitter(data=ac.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("hpm3.AvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
MuscleSvC.ipath.filt <- MuscleSvC.ipath %>% filter(pv_fdr <= p.Cutoff)
MuscleSvC.ipath.filt <- tibble::rownames_to_column(MuscleSvC.ipath.filt,"UniqName")
sc.ipath.nohit <- MuscleSvC.ipath.filt %>% filter(Hit == "Other")
sc.ipath.hit <- MuscleSvC.ipath.filt %>% filter(Hit == "Hit")
sc.ipath.plot <- ggplot() + geom_jitter(data=sc.ipath.nohit, aes(x="Collection",y=pv_fdr), color="black", alpha=0.4, size=0.6, width=0.1) + geom_jitter(data=sc.ipath.hit, aes(x="Collection",y=pv_fdr), color="red", alpha=1, size=2, width=0.1) + theme_void() + ggtitle("MuscleSvC") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(color = "black", size=1)) + coord_flip()
ggarrange(ec.ipath.plot,g1rev.ipath.plot,ac.ipath.plot,sc.ipath.plot, legend = FALSE, ncol=4, nrow=1)
evc.KEGG <- read.xlsx("../shared_data/EvC_KEGG_Summary.xlsx", colNames=TRUE, rowNames=TRUE)
evc.KEGG.ppar <- evc.KEGG %>% filter(Group == "PPAR")
evc.KEGG.other <- evc.KEGG %>% filter(Group == "Other")
ggplot() + geom_jitter(data=evc.KEGG.other, aes(x=Method,y=pval), color="black", alpha=0.5, size=2, width=0.1) + geom_jitter(data=evc.KEGG.ppar, aes(x=Method,y=pval), color="red", alpha=1, size=4, width=0.1) + theme_bw() + coord_flip()
