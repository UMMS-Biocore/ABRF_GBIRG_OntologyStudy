boxplot7.2
dev.off()
table(plus300$Group)
table(sub300$Group)
table(msig7.2$Group)
as.data.frame(msig7.2 %>% group_by(Group) %>% summarize(n(),median(Size), mean(Size)))
g1revterm <- read.xlsx("../shared_data/G1vRev_data_withTerm.xlsx", colNames=TRUE, rowNames=TRUE)
g1revterm.Hit <- g1revterm %>% filter(GroupWithabsFC0.4 == "Yes")
g1revterm.Other <- g1revterm %>% filter(GroupWithabsFC0.4 == "No")
g1rev.termHit.pub <- ggplot() + geom_point(data=g1revterm.Other, aes(x=logFC, y=neglogP), color="grey", alpha=0.4, size=0.6) +
geom_point(data=g1revterm.Hit, aes(x=logFC, y=neglogP), color="blue", alpha=1, size=2) +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(limits = c(-2,2)) +
theme_classic() + theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.termHit.pub
pdf('g1rev.termHit.pdf',width=10, height=10)
g1rev.termHit.pub
dev.off()
g1revterm <- read.xlsx("../shared_data/G1vRev_data_withTerm.xlsx", colNames=TRUE, rowNames=TRUE)
g1revterm.Hit <- g1revterm %>% filter(GroupWithabsFC0.4 == "Yes")
g1revterm.Other <- g1revterm %>% filter(GroupWithabsFC0.4 == "No")
g1rev.termHit.pub <- ggplot() + geom_point(data=g1revterm.Other, aes(x=logFC, y=neglogP), color="grey", alpha=0.4, size=0.6) +
geom_point(data=g1revterm.Hit, aes(x=logFC, y=neglogP), color="blue", alpha=1, size=2) +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(limits = c(-2,2)) +
theme_classic() + theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.termHit.pub
pdf('g1rev.termHit.pdf',width=6, height=6)
g1rev.termHit.pub
dev.off()
g1revterm <- read.xlsx("../shared_data/G1vRev_data_withTerm.xlsx", colNames=TRUE, rowNames=TRUE)
g1revterm.Hit <- g1revterm %>% filter(GroupWithabsFC0.4 == "Yes")
g1revterm.Other <- g1revterm %>% filter(GroupWithabsFC0.4 == "No")
g1rev.termHit.pub <- ggplot() + geom_point(data=g1revterm.Other, aes(x=logFC, y=neglogP), color="grey", alpha=0.4, size=0.6) +
geom_point(data=g1revterm.Hit, aes(x=logFC, y=neglogP), color="blue", alpha=1, size=2) +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(limits = c(-2,2)) +
theme_classic() + theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.termHit.pub
pdf('g1rev.termHit.pdf')
g1rev.termHit.pub
dev.off()
svcDE.st <- read.xlsx("../shared_data/musc_SkeVHeart_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE.2 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 2,"de","other"))
svcDE.4 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 4,"de","other"))
svcDEup <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & logFC >= 1,"de","other"))
svcDEup.2 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & logFC >=  2,"de","other"))
svcDEup.4 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & logFC >= 4,"de","other"))
a <- ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
b <- ggplot(svcDE.2) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
c <- ggplot(svcDE.4) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
d <- ggplot(svcDEup) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
e <- ggplot(svcDEup.2) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
f <- ggplot(svcDEup.4) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
svcVol.pub <- ggarrange(a,b,c,d,e,f, legend = FALSE, ncol=1, nrow=6)
svcVol.pub
pdf('svcVol.pdf')
svcVol.pub
dev.off()
g1revterm <- read.xlsx("../shared_data/G1vRev_data_withTerm.xlsx", colNames=TRUE, rowNames=TRUE)
g1revterm.Hit <- g1revterm %>% filter(GroupWithabsFC0.4 == "Yes")
g1revterm.Other <- g1revterm %>% filter(GroupWithabsFC0.4 == "No")
g1rev.termHit.pub <- ggplot() + geom_point(data=g1revterm.Other, aes(x=logFC, y=neglogP), color="grey", alpha=0.4, size=1) +
geom_point(data=g1revterm.Hit, aes(x=logFC, y=neglogP), color="blue", alpha=1, size=2) +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(limits = c(-1.75,1.75)) +
theme_classic() + theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.termHit.pub
pdf('g1rev.termHit.pdf')
g1rev.termHit.pub
dev.off()
g1revterm <- read.xlsx("../shared_data/G1vRev_data_withTerm.xlsx", colNames=TRUE, rowNames=TRUE)
g1revterm.Hit <- g1revterm %>% filter(GroupWithabsFC0.4 == "Yes")
g1revterm.Other <- g1revterm %>% filter(GroupWithabsFC0.4 == "No")
g1rev.termHit.pub <- ggplot() + geom_point(data=g1revterm.Other, aes(x=logFC, y=neglogP), color="darkgrey", alpha=0.4, size=1.2) +
geom_point(data=g1revterm.Hit, aes(x=logFC, y=neglogP), color="blue", alpha=1, size=2) +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(limits = c(-1.5,1.5)) +
theme_classic() + theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.termHit.pub
pdf('g1rev.termHit.pdf')
g1rev.termHit.pub
dev.off()
g1revDEst <- read.xlsx("../shared_data/G1vRev_data_vol_mod.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE.58 <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 0.58,"de","other"))
g1revDEdw <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & logFC <= -1,"de","other"))
g1revDEdw.58 <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & logFC <=  -0.58,"de","other"))
a <- ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("abs(logFC) >= 1, 102 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
b <- ggplot(g1revDE.58) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("abs(logFC) >= 0.58, 466 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
c <- ggplot(g1revDEdw) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("logFC <= -1, 62 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
d <- ggplot(g1revDEdw.58) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("logFC <= -0.58, 268 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.filt.pub <- ggarrange(a,b,c,d, legend = FALSE, ncol=4, nrow=1)
g1rev.filt.pub
pdf('g1rev.filt.pdf')
g1rev.filt.pub
dev.off()
table(g1revDE$threshold)
table(g1revDE.58$threshold)
table(g1revDEdw$threshold)
table(g1revDEdw.58$threshold)
g1revDEst <- read.xlsx("../shared_data/G1vRev_data_vol_mod.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE.58 <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 0.58,"de","other"))
g1revDEdw <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & logFC <= -1,"de","other"))
g1revDEdw.58 <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & logFC <=  -0.58,"de","other"))
a <- ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("abs(logFC) >= 1, 102 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
b <- ggplot(g1revDE.58) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("abs(logFC) >= 0.58, 466 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
c <- ggplot(g1revDEdw) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("logFC <= -1, 62 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
d <- ggplot(g1revDEdw.58) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("logFC <= -0.58, 268 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.filt.pub <- ggarrange(a,b,c,d, legend = FALSE, ncol=4, nrow=1)
g1rev.filt.pub
pdf('g1rev.filt.pdf',fig.width=20, fig.height=4)
g1revDEst <- read.xlsx("../shared_data/G1vRev_data_vol_mod.xlsx", colNames=TRUE, rowNames=TRUE)
g1revDE <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
g1revDE.58 <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 0.58,"de","other"))
g1revDEdw <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & logFC <= -1,"de","other"))
g1revDEdw.58 <- g1revDEst %>% mutate(threshold = ifelse(adp <= 0.05 & logFC <=  -0.58,"de","other"))
a <- ggplot(g1revDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("abs(logFC) >= 1, 102 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
b <- ggplot(g1revDE.58) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("abs(logFC) >= 0.58, 466 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
c <- ggplot(g1revDEdw) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("logFC <= -1, 62 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
d <- ggplot(g1revDEdw.58) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
ggtitle("logFC <= -0.58, 268 DEGs") +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,13)) +
scale_x_continuous(limits = c(-2.2,2.2)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.filt.pub <- ggarrange(a,b,c,d, legend = FALSE, ncol=4, nrow=1)
g1rev.filt.pub
pdf('g1rev.filt.pdf',width=20, height=4)
g1rev.filt.pub
dev.off()
table(g1revDE$threshold)
table(g1revDE.58$threshold)
table(g1revDEdw$threshold)
table(g1revDEdw.58$threshold)
g1revterm <- read.xlsx("../shared_data/G1vRev_data_withTerm.xlsx", colNames=TRUE, rowNames=TRUE)
g1revterm.Hit <- g1revterm %>% filter(GroupWithabsFC0.4 == "Yes")
g1revterm.Other <- g1revterm %>% filter(GroupWithabsFC0.4 == "No")
g1rev.termHit.pub <- ggplot() + geom_point(data=g1revterm.Other, aes(x=logFC, y=neglogP), color="darkgrey", alpha=0.4, size=2) +
geom_point(data=g1revterm.Hit, aes(x=logFC, y=neglogP), color="blue", alpha=1, size=3) +
xlab("log2FC") +
ylab("negLogP") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(limits = c(-1.75,1.75)) +
theme_classic() + theme(legend.position = "none",
plot.title = element_text(size = rel(1.7), hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
panel.background = element_rect(fill = "white"))
g1rev.termHit.pub
pdf('g1rev.termHit.pdf')
g1rev.termHit.pub
dev.off()
evc.KEGG <- read.xlsx("../shared_data/EvC_KEGG_Summary.xlsx", colNames=TRUE, rowNames=TRUE)
evc.KEGG.ppar <- evc.KEGG %>% filter(Group == "PPAR")
evc.KEGG.other <- evc.KEGG %>% filter(Group == "Other")
ggplot() + geom_jitter(data=evc.KEGG.other, aes(x=Method,y=pval), color="black", alpha=0.5, size=2, width=0.1) + geom_jitter(data=evc.KEGG.ppar, aes(x=Method,y=pval), color="red", alpha=1, size=4, width=0.1) + theme_bw() + coord_flip()
evc.KEGG <- read.xlsx("../shared_data/EvC_KEGG_Summary.xlsx", colNames=TRUE, rowNames=TRUE)
evc.KEGG <- evc.KEGG %>% mutate(neglogP = -log10(pval))
evc.KEGG.ppar <- evc.KEGG %>% filter(Group == "PPAR")
evc.KEGG.other <- evc.KEGG %>% filter(Group == "Other")
ggplot() + geom_jitter(data=evc.KEGG.other, aes(x=Method,y=neglogP), color="black", alpha=0.5, size=2, width=0.2) + geom_jitter(data=evc.KEGG.ppar, aes(x=Method,y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
evc.KEGG <- read.xlsx("../shared_data/EvC_KEGG_Summary.xlsx", colNames=TRUE, rowNames=TRUE)
evc.KEGG <- evc.KEGG %>% mutate(neglogP = -log10(pval))
evc.KEGG.ppar <- evc.KEGG %>% filter(Group == "PPAR")
evc.KEGG.other <- evc.KEGG %>% filter(Group == "Other")
ppar.pub <- ggplot() + geom_jitter(data=evc.KEGG.other, aes(x=Method,y=neglogP), color="black", alpha=0.5, size=2, width=0.2) + geom_jitter(data=evc.KEGG.ppar, aes(x=Method,y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
ppar.pub
pdf('ppar.pub.pdf')
ppar.pub
dev.off()
avc.path <- read.xlsx("../shared_data/IL17_pathways_summaryFigure.xlsx", colNames=TRUE, rowNames=TRUE)
avc.path <- avc.path %>% mutate(neglogP = -log10(pval))
avc.path.il17best <- avc.path %>% filter(Group == "IL17best")
avc.path.il17 <- avc.path %>% filter(Group == "IL17")
avc.path.other <- avc.path %>% filter(Group == "Other")
ggplot() + geom_jitter(data=avc.path.other, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="black", alpha=0.2, size=1, width=0.2) + geom_jitter(data=avc.path.il17, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA', 'DAVID')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=avc.path.il17best, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
avc.path <- read.xlsx("../shared_data/IL17_pathways_summaryFigure.xlsx", colNames=TRUE, rowNames=TRUE)
avc.path <- avc.path %>% mutate(neglogP = -log10(pval))
avc.path.il17best <- avc.path %>% filter(Group == "IL17best")
avc.path.il17 <- avc.path %>% filter(Group == "IL17")
avc.path.other <- avc.path %>% filter(Group == "Other")
ggplot() + geom_jitter(data=avc.path.other, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="black", alpha=0.2, size=1, width=0.2) + geom_jitter(data=avc.path.il17, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA', 'DAVID')),y=neglogP), color="blue", alpha=0.6, size=3, width=0.2) + geom_jitter(data=avc.path.il17best, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
avc.path <- read.xlsx("../shared_data/IL17_pathways_summaryFigure.xlsx", colNames=TRUE, rowNames=TRUE)
avc.path <- avc.path %>% mutate(neglogP = -log10(pval))
avc.path.il17best <- avc.path %>% filter(Group == "IL17best")
avc.path.il17 <- avc.path %>% filter(Group == "IL17")
avc.path.other <- avc.path %>% filter(Group == "Other")
ggplot() + geom_jitter(data=avc.path.other, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="black", alpha=0.2, size=1, width=0.2) + geom_jitter(data=avc.path.il17, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA', 'DAVID')),y=neglogP), color="blue", alpha=0.6, size=3, width=0.2) + geom_jitter(data=avc.path.il17best, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
avc.path <- read.xlsx("../shared_data/IL17_pathways_summaryFigure.xlsx", colNames=TRUE, rowNames=TRUE)
avc.path <- avc.path %>% mutate(neglogP = -log10(pval))
avc.path.il17best <- avc.path %>% filter(Group == "IL17best")
avc.path.il17 <- avc.path %>% filter(Group == "IL17")
avc.path.other <- avc.path %>% filter(Group == "Other")
ggplot() + geom_jitter(data=avc.path.other, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="grey", alpha=0.2, size=1, width=0.2) + geom_jitter(data=avc.path.il17, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA', 'DAVID')),y=neglogP), color="blue", alpha=0.6, size=3, width=0.2) + geom_jitter(data=avc.path.il17best, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
avc.path <- read.xlsx("../shared_data/IL17_pathways_summaryFigure.xlsx", colNames=TRUE, rowNames=TRUE)
avc.path <- avc.path %>% mutate(neglogP = -log10(pval))
avc.path.il17best <- avc.path %>% filter(Group == "IL17best")
avc.path.il17 <- avc.path %>% filter(Group == "IL17")
avc.path.other <- avc.path %>% filter(Group == "Other")
ggplot() + geom_jitter(data=avc.path.other, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="darkgrey", alpha=0.2, size=1, width=0.2) + geom_jitter(data=avc.path.il17, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA', 'DAVID')),y=neglogP), color="blue", alpha=0.6, size=3, width=0.2) + geom_jitter(data=avc.path.il17best, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
avc.path <- read.xlsx("../shared_data/IL17_pathways_summaryFigure.xlsx", colNames=TRUE, rowNames=TRUE)
avc.path <- avc.path %>% mutate(neglogP = -log10(pval))
avc.path.il17best <- avc.path %>% filter(Group == "IL17best")
avc.path.il17 <- avc.path %>% filter(Group == "IL17")
avc.path.other <- avc.path %>% filter(Group == "Other")
avc.IL17.pub <- ggplot() + geom_jitter(data=avc.path.other, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="darkgrey", alpha=0.2, size=1, width=0.2) + geom_jitter(data=avc.path.il17, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA', 'DAVID')),y=neglogP), color="blue", alpha=0.6, size=3, width=0.2) + geom_jitter(data=avc.path.il17best, aes(x=factor(Tool, level = c('Metacore','ipathway','IPA','gprofiler','GSEA','DAVID')),y=neglogP), color="red", alpha=1, size=4, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
avc.IL17.pub
pdf('avc.IL17.pdf')
avc.IL17.pub
dev.off()
svc.gpBP <- read.xlsx("../shared_data/musc_GOBP_tests.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
svc.gpBP <- svc.gpBP %>% mutate(neglogP = -log10(p_value))
svc.gpBP.best <- svc.gpBP %>% filter(Hit == "Best")
svc.gpBP.hit <- svc.gpBP %>% filter(Hit == "Hit")
svc.gpBP.other <- svc.gpBP %>% filter(Hit == "Other")
ggplot() + geom_jitter(data=svc.gpBP.other, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="black", alpha=0.1, size=1, width=0.2) + geom_jitter(data=svc.gpBP.hit, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=svc.gpBP.best, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
svc.gpBP <- read.xlsx("../shared_data/musc_GOBP_tests.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
svc.gpBP <- svc.gpBP %>% mutate(neglogP = -log10(p_value))
svc.gpBP.best <- svc.gpBP %>% filter(Hit == "Best")
svc.gpBP.hit <- svc.gpBP %>% filter(Hit == "Hit")
svc.gpBP.other <- svc.gpBP %>% filter(Hit == "Other")
svc.pub <- ggplot() + geom_jitter(data=svc.gpBP.other, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="black", alpha=0.1, size=1, width=0.2) + geom_jitter(data=svc.gpBP.hit, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=svc.gpBP.best, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
svc.pub
pdf('svc.pdf')
svc.pub
dev.off()
svc.gpBP <- read.xlsx("../shared_data/musc_GOBP_tests.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
svc.gpBP <- svc.gpBP %>% mutate(neglogP = -log10(p_value))
svc.gpBP.best <- svc.gpBP %>% filter(Hit == "Best")
svc.gpBP.hit <- svc.gpBP %>% filter(Hit == "Hit")
svc.gpBP.other <- svc.gpBP %>% filter(Hit == "Other")
svc.pub <- ggplot() + geom_jitter(data=svc.gpBP.other, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="black", alpha=0.1, size=1, width=0.2) + geom_jitter(data=svc.gpBP.hit, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=svc.gpBP.best, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
svc.pub
pdf('svc.pdf')
svc.pub
dev.off()
svcDE.st <- read.xlsx("../shared_data/musc_SkeVHeart_data_vol.xlsx", colNames=TRUE, rowNames=TRUE)
svcDE <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 1,"de","other"))
svcDE.2 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 2,"de","other"))
svcDE.4 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & abs(logFC) >= 4,"de","other"))
svcDEup <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & logFC >= 1,"de","other"))
svcDEup.2 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & logFC >=  2,"de","other"))
svcDEup.4 <- svcDE.st %>% mutate(threshold = ifelse(adp <= 0.05 & logFC >= 4,"de","other"))
a <- ggplot(svcDE) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
b <- ggplot(svcDE.2) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
c <- ggplot(svcDE.4) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
d <- ggplot(svcDEup) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
e <- ggplot(svcDEup.2) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
f <- ggplot(svcDEup.4) +
geom_point(aes(x=logFC, y=-log10(adp), color=threshold)) +
scale_color_manual(values=c("red", "grey")) +
scale_y_continuous(limits = c(0,55),labels = NULL, breaks = NULL) +
scale_x_continuous(limits = c(-12,12),labels = NULL, breaks = NULL) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill = "white"))
svcVol.pub <- ggarrange(a,b,c,d,e,f, legend = FALSE, ncol=1, nrow=6)
svcVol.pub
pdf('svcVol.pdf', width=1,height=1)
svcVol.pub
dev.off()
svc.gpBP <- read.xlsx("../shared_data/musc_GOBP_tests.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
svc.gpBP <- svc.gpBP %>% mutate(neglogP = -log10(p_value))
svc.gpBP.best <- svc.gpBP %>% filter(Hit == "Best")
svc.gpBP.hit <- svc.gpBP %>% filter(Hit == "Hit")
svc.gpBP.other <- svc.gpBP %>% filter(Hit == "Other")
svc.pub <- ggplot() + geom_jitter(data=svc.gpBP.other, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="grey", alpha=0.1, size=1, width=0.2) + geom_jitter(data=svc.gpBP.hit, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=svc.gpBP.best, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
svc.pub
pdf('svc.pdf')
svc.pub
dev.off()
svc.gpBP <- read.xlsx("../shared_data/musc_GOBP_tests.gprofiler_withOverlaps.xlsx", colNames=TRUE, rowNames=TRUE)
svc.gpBP <- svc.gpBP %>% mutate(neglogP = -log10(p_value))
svc.gpBP.best <- svc.gpBP %>% filter(Hit == "Best")
svc.gpBP.hit <- svc.gpBP %>% filter(Hit == "Hit")
svc.gpBP.other <- svc.gpBP %>% filter(Hit == "Other")
svc.pub <- ggplot() + geom_jitter(data=svc.gpBP.other, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="darkgrey", alpha=0.1, size=1, width=0.2) + geom_jitter(data=svc.gpBP.hit, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="blue", alpha=0.6, size=2, width=0.2) + geom_jitter(data=svc.gpBP.best, aes(x=factor(Run, level = c('updegs4FC','updegs2FC','updegs1FC','degs4FC','degs2FC','degs1FC')),y=neglogP), color="red", alpha=1, size=3, width=0.2) + geom_hline(aes(yintercept=1.3, color = "red"), size=1, show.legend=FALSE) + theme_bw() + coord_flip()
svc.pub
pdf('svc.pdf')
svc.pub
dev.off()
